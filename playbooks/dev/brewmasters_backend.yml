---

# the following is for backend deployment to the newly created container
# of course it's only a development setting

- hosts: pseudo-raspbian
  gather_facts: false
  pre_tasks:
    - name: RAW | install python3 on target
      become: true
      raw: >
        test -e {{ ansible_python_interpreter }} ||
        apt -y update && apt install -y python3
      tags: install

    - name: Gather facts
      setup:

    - name: APT | install ansible module requirements
      become: true
      apt:
        name: "{{ item }}"
        update_cache: true
        state: present
      loop: "{{ ansible_dependencies }}"

  roles:
    - role: ansible-role-timescaledb
    - role: ansible-role-brewmaster-backend
      vars:
        backend_environments:
          DATABASE_PASSWORD: brewmasters
